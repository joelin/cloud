#云感知应用架构

##应用程序架构演进历程
应用程序体系结构跟随计算机硬件、 网络和设备从个人电脑到智能手机同步发展至今。云计算作为最新的进化力量，正在改变应用程序体系结构。要了解云计算正在怎样改变应用程序体系架构，思考在常规非云环境应用是如何架构。
###多层应用架构
比如典型的三层架构由展示层、中间层、数据层三层构建
- 展示层提供用户访问接口
- 中间层接受用户请求并执行应用业务逻辑
- 数据层提供数据存储服务

比如典型的邮件服务器架构，展示层使用outlook类似的客户端，中间层消息服务器ExchangeServer，后端的消息存储数据层；中间层通过应用协议(IMAP)提供api服务给客户端调用，中间层往往会与多个后端服务存在接口，比如邮件系统中，中间层会与用户体系的目录服务、消息存储服务、消息传输代理等有接口。

![muti-tier](muti-tier architecture.png)

三层架构词条：解释略

###虚拟环境中的多层应用架构
随着数据中心虚拟化技术的应用，越来越多的应用部署在虚拟化环境中，这样可以节省更多的成本和资源调配的时间。
对于应用程序来说，虚拟化环境几乎都是同质化的，包含应用的构造方法、配置静态数据等。由于虚拟环境可以根据需求创建和配置新的应用组件的实例，配合虚拟感知的负载技术、虚拟IP技术使扩展变得更容易，而且每层的独立扩展相对于其它层来说都是透明的。


###云应用架构
在云环境开发应用时，开发人员不一定非的改造应用的架构来适应云环境，开发人员照样可以把应用部署在云环境中，比如使用P2V方法，把物理机的应用原样迁移到虚拟机中，但是这样会妨碍应用使用云的特殊功能。比如原来的多层部署模式，耦合了依赖层的相关信息(服务信息、IP地址、web相关配置等)，这样就无法做到自动化扩展到多个虚机或私有、公共云的多个实例。如果要有效地利用云的功能，那么应用在设计架构时，就要基于云的思想和特性去考虑应用的架构，包含弹性、自助服务、多租户等等。例如下图展示的传统多层和云应用比较。

![muti vs cloud](muti-tier vs cloud.png)

##云应用架构原则
本节概述了云计算的应用程序体系结构的根本原则，表 1 列出了结构原则:它影响应用程序自身是如何组织、编码、确定最终用户怎样与之交互；表 3 总结了操作准则：它考虑了整个系统，包括如何部署应用程序的工作原理和操作，以及其他系统组件如何与之进行交互。

这些原则一般适用基于特定应用程序的上下文，并可能随着时间的推移逐步实施。在开发云知道应用程序时，表中优先级为高的原则应该优先考虑，低优先级的原则在云感知的架构中并不显得那么重要。

表 1. 结构原则

| 序号 | 原则 |描述|优先级
|--------|--------|---------|----------|
| 1|故障弹性 |弹性设计到应用程序中，而不是事后对应用的包装。这样对云计算基础设施的故障能够不中断服务的流畅处理|高|
| 2|延迟弹性 |优雅延迟的应用由于超时和中断的应用|高|
| 3|安全性|应用程序是基于生命周期的安全标准，包括内置的安全性。<br>落地的数据和传输的数据是加密的，API有认证和授权的保护|高|
| 4|位置无关|应用应动态的发现服务，而不是依赖硬编码|高|
| 5|弹性可伸缩||高|

###云应用结构原则



